:root{--bg:#0b0f14;--panel:#111823;--ink:#e0efff;--ink2:#9bb4d1;--accent:#5ee7a2;--accent2:#3bd1ff;--danger:#ff6b6b;--muted:#233040}
html,body{height:100%}
body{margin:0;background:linear-gradient(135deg,#0b0f14,#0d1220 40%,#0b0f14);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";display:flex;flex-direction:column;align-items:center;gap:16px;padding:16px}
header{width:min(1100px,95vw);display:flex;flex-wrap:wrap;gap:8px 12px;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.04em}
.brand .dot{width:10px;height:10px;border-radius:50%;background:conic-gradient(from 90deg,var(--accent),var(--accent2));box-shadow:0 0 16px var(--accent)}
.panel{width:min(1100px,95vw);background:color-mix(in display-p3,var(--panel) 85%,black);border:1px solid #1a2635;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:14px;display:flex;gap:14px;flex-wrap:wrap;align-items:center;justify-content:space-between}
.controls{display:flex;flex-wrap:wrap;gap:8px;align-items:center}
.controls label{font-size:14px;color:var(--ink2)}
.controls .pill{display:inline-flex;align-items:center;gap:8px;background:#0f1725;border:1px solid #1c2a3d;color:var(--ink);padding:8px 12px;border-radius:999px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.03)}
.btn{appearance:none;border:none;background:linear-gradient(180deg,#152338,#0f1a2a);color:var(--ink);border:1px solid #1d2b42;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700;letter-spacing:.02em;transition:.15s transform ease,.2s box-shadow ease}
.btn:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.35)}
.btn:active{transform:translateY(0)}
.btn.primary{background:linear-gradient(180deg,var(--accent2),#0099ff);color:#000;border:0;box-shadow:0 6px 20px rgba(0,153,255,.35)}
.btn.success{background:linear-gradient(180deg,#63f0b1,#24c97e);color:#000;border:0;box-shadow:0 6px 20px rgba(36,201,126,.3)}
.btn.danger{background:linear-gradient(180deg,#ff9b9b,#ff6b6b);color:#000;border:0;box-shadow:0 6px 20px rgba(255,107,107,.3)}
.stats{display:flex;gap:14px;flex-wrap:wrap;align-items:center;color:var(--ink2)}
.stats .chip{background:#0f1725;padding:8px 12px;border:1px solid #1b2a3e;border-radius:999px}
#stageWrap{width:min(1100px,95vw);aspect-ratio:1/1;height:min(90vh,95vw);min-height:320px;background:#0b111a;border:1px solid #1a2635;border-radius:20px;overflow:hidden;position:relative}
canvas{width:100%;height:100%;display:block}
.help{max-width:850px;color:var(--ink2);line-height:1.6}
.control-row{display:flex;gap:8px;flex-wrap:wrap}
.toast{position:fixed;inset:auto 0 16px 0;display:flex;justify-content:center;pointer-events:none}
.toast .msg{pointer-events:auto;background:#0d1624;border:1px solid #1b2b41;border-radius:12px;padding:10px 14px;color:var(--ink);box-shadow:0 10px 20px rgba(0,0,0,.35)}
.btn[disabled]{opacity:.5;cursor:not-allowed}
.overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.55);backdrop-filter:blur(2px);z-index:60}
.overlay[hidden]{display:none}
.dialog{background:color-mix(in display-p3,var(--panel) 88%,black);border:1px solid #1a2635;border-radius:16px;padding:20px;width:min(520px,92vw);text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.45)}
.dialog h2{margin:8px 0 12px;font-size:28px}
.dialog p{color:var(--ink2)}
.actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}